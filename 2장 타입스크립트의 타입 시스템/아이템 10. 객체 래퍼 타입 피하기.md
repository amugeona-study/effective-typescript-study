## 객체 래퍼 타입 피하기

자바스크립트는 객체 이외에도 기본형 값들에 대한 일곱 가지 타입(`string`, `number`, `boolean`, `null`, `undefined`, `symbol`, `bigint`)가 있다.  
기본형들은 불변(immutable)이며, 메서드를 가지지 않는다는 점에서 객체와 구분된다. 그런데 기본형인 `string`의 경우 `charAt`과 같이 메서드를 가지고 있는 것처럼 보인다.  

하지만 사실 `charAt`은 `string`의 메서드가 아니며, `string`을 사용할 때 자바스크립트 내부적으로 많은 동작이 일어난다. `string` '기본형'에는 메서드가 없지만, 자바스크립트에는 메서드를 가지는 `String` '객체' 타입이 정의되어 있다.  

자바스크립트는 기본형과 객체 타입을 서로 자유롭게 변환한다. `string` 기본형에 `charAt`같은 메서드를 사용할 때, 자바스크립트는 기본형을 `String` 객체로 래핑하고, 메서드를 호출하고, 마지막에 래핑한 객체를 버린다.  

만약 `String.prototype`을 몽키-패치(_런타임에 프로그램의 어떤 기능을 수정해서 사용하는 기법: 자바스크립트에서는 주로 프로토타입 변경_) 한다면 앞서 설명한 내부적인 동작들을 관찰할 수 있다.

```ts
// Don't do this!
const originalCharAt = String.prototype.charAt;
String.prototype.charAt = function(pos) {
  console.log(this, typeof this, pos);
  return originalCharAt.call(this, pos);
};
console.log('primitive'.charAt(3));
```
해당 코드의 결과값으로 `[String: 'primitive'] 'object' 3 m`이 나오는 것을 볼 수 있다.  

메서드 내의 `this`는 `string` 기본형이 아닌 `String` 객체 래퍼다. `String` 객체를 직접 생성할 수도 있으며, `string` 기본형처럼 동작한다. 하지만 `string` 기본형과 `String` 객체 래퍼가 항상 동일하게 동작하는 것은 아니다. 예를 들어, `String` 객체는 오직 자기 자신과만 동일하다.

